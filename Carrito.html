<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrito de Compras</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">Carrito de Compras</h1>
        <!-- Tabla del carrito -->
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Producto</th>
                    <th>Cantidad</th>
                    <th>Precio</th>
                    <th>Total</th>
                    <th>Acción</th>
                </tr>
            </thead>
            <tbody id="cart-items">
                <!-- Aquí se llenarán los productos dinámicamente -->
            </tbody>
        </table>
        <div class="text-center mt-4">
            <button class="btn btn-primary">Pagar</button>
        </div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // Obtener datos del carrito y mostrarlos en la tabla
        function cargarCarrito() {
            $.getJSON('backend/obtener_carrito.php', function (data) {
                let contenido = '';
                let totalGeneral = 0;

                data.forEach(item => {
                    const total = item.cantidad * item.precio;
                    totalGeneral += total;
                    contenido += `
                        <tr>
                            <td>${item.nombre}</td>
                            <td>${item.cantidad}</td>
                            <td>$${item.precio.toFixed(2)}</td>
                            <td>$${total.toFixed(2)}</td>
                            <td><button class="btn btn-danger btn-sm" onclick="eliminarDelCarrito(${item.id})">Eliminar</button></td>
                        </tr>`;
                });

                contenido += `
                    <tr>
                        <td colspan="3" class="text-end"><strong>Total General</strong></td>
                        <td colspan="2"><strong>$${totalGeneral.toFixed(2)}</strong></td>
                    </tr>`;

                $('#cart-items').html(contenido);
            });
        }

        // Función para eliminar un producto del carrito
        function eliminarDelCarrito(id) {
            $.post('backend/eliminar_carrito.php', { id: id }, function () {
                cargarCarrito(); // Recargar el carrito después de eliminar
            });
        }

        // Llamar a la función al cargar la página
        $(document).ready(() => {
            cargarCarrito();
        });
    </script>
</body>

</html>


